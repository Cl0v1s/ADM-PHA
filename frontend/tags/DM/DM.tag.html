<app-dm>
    <img id="dmpicture" src="{ dm.picture }">
    <div class="description">
        <h3>Description</h3>
        <div class="img">
        </div>
        <div>
            <p>
                { dm.description }
            </p>
        </div>
    </div>

    <div class="autonomy">
      <h3>Degré d'autonomie</h3>
        <div class="img">
        </div>
        <div>
            <p>
                { dm.autonomy }
            </p>
        </div>
    </div>

    <div class="guide">
      <h3>Guide d'utilisation</h3>
        <div class="img">

        </div>
        <div>
            <p>
                { dm.guide }
            </p>
        </div>
    </div>

    <div class="invasive">
      <h3>Caractère invasif</h3>
        <div class="img">
        </div>
        <div>
            <p>
                { dm.invasive }
            </p>
        </div>
    </div>

    <div class="advantages">
      <h3>Avantages et inconvénients</h3>
        <div class="img">
        </div>
        <div>
            <p>
                { dm.advantages }
            </p>
        </div>
    </div>

    <div class="market">
      <h3>Fabricants / prix</h3>
        <div class="img">
        </div>
        <div>
            <div>
                <label>Prix moyen</label>
                <p>{ dm.price }</p>
            </div>
            <div>
                <label>Fabricants</label>
                <p>
                    <!--TODO: ajouter les informations sur les fabricants -->
                </p>
            </div>
        </div>
    </div>

    <div if="{ dm.comments != null }" class="comments">
        <h2>Commentaires</h2>
        <app-commentEditForm if="{ resident != null}" resident="{ resident }" dm="{ dm }" callback="{ afterComment }" ></app-commentEditForm>
        <app-comments comments="{ dm.comments }"></app-comments>
    </div>


    <script>
        var tag = this;

        tag.dm = null;
        tag.resident = null;

        tag.on("before-mount", function(){
            tag.dm = tag.opts.dm;
            if(tag.dm == null)
                throw new Error("DM cant be null.");
            tag.resident = tag.opts.resident;
        });

        tag.afterComment = function(comment)
        {
            if(dm.comments == null)
                return;
            dm.comments.push(comment);
            tag.update();
        }

    </script>
</app-dm>
