<app-dm>
  <div>
    <div class="header">
      <p>
      { dm.name }
      </p>
      <p if="{ dm.type == 0 || dm.type == '0' }"  href="#dm/{dm.id}" class="button add">Dispositif médical</p>
      <p if="{ dm.type == 1 || dm.type == '1' }"  href="#at/{dm.id}" class="button add">Aide technique</p>
    </div>
    <div style="background-image: url('{dm.picture}')"></div>
  </div>

    <div class="description">
        <h3>Description</h3>
        <div class="img">
          <img alt="" src="../../static/IMG/desc.png"/>
        </div>
        <span class="divider"></span>
        <div>
          {dm.description}
        </div>
    </div>

    <div class="autonomy">
      <h3>Degré d'autonomie</h3>
      <div class="img">
        <img alt="" src="../../static/IMG/autonomy.png"/>
      </div>
      <span class="divider"></span>
      <div>
        {dm.autonomy}
      </div>
    </div>

    <div class="guide">
      <h3>Guide d'utilisation</h3>
      <div class="img">
        <img alt="" src="../../static/IMG/conseils.png"/>
      </div>
      <span class="divider"></span>
      <div>
        {dm.guide}
      </div>
    </div>

    <div class="invasive">
        <h3>Caractère invasif</h3>
        <div class="img">
          <img alt="" src="../../static/IMG/invasif.png"/>
        </div>
        <span class="divider"></span>
        <div>
          {dm.invasive}
        </div>
      </div>

      <div class="advantages">
      <h3>Avantages et inconvénients</h3>
          <div class="img">
            <img alt="" src="../../static/IMG/inconv.png"/>
          </div>
          <span class="divider"></span>
          <div>
            {dm.advantages}
          </div>
        </div>

        <div class="price">
      <h3>Fabricants / prix</h3>
          
                <div class="img">
                  <img alt="" src="../../static/IMG/price.png"/>
                </div>
                <span class="divider"></span>
                <div>
                    <label>Prix moyen: { dm.price }€</label><br><br>
                    <label>Fabricants</label>
                    <p>
                        <!--TODO: ajouter les informations sur les fabricants -->
                    </p>
                </div>
              </div>


    <div if="{ dm.comments != null }" class="comments">
        <h2>Commentaires</h2>
        <app-commentEditForm if="{ resident != null}" resident="{ resident }" dm="{ dm }" callback="{ afterComment }" ></app-commentEditForm>
        <app-comments comments="{ dm.comments }"></app-comments>
    </div>


    <script>
        var tag = this;

        tag.dm = null;
        tag.resident = null;

        tag.on("before-mount", function(){
            tag.dm = tag.opts.dm;
            if(tag.dm == null)
                throw new Error("DM cant be null.");
            tag.resident = tag.opts.resident;
        });

        tag.afterComment = function(comment)
        {
            if(dm.comments == null)
                return;
            dm.comments.push(comment);
            tag.update();
        }

    </script>
</app-dm>
